changes from fix-bug branch
